services:
    # a wrapper class that injects dependencies
    wolnosciowiec.file_repository.comrade:
        class: Wolnosciowiec\FileRepositoryBundle\Service\Comrade\ComradeReader

    wolnosciowiec.file_repository.registry:
        class: Wolnosciowiec\FileRepositoryBundle\Service\FileRegistry
        arguments:
            comrade: "@wolnosciowiec.file_repository.comrade"

    wolnosciowiec.file_repository.uploader:
        class: Wolnosciowiec\FileRepositoryBundle\Service\FileUploader
        arguments:
            comrade: "@wolnosciowiec.file_repository.comrade"

    # repository of local cached resources
    wolnosciowiec.file_repository.repository.cached_resource:
        class: Doctrine\ORM\EntityRepository
        factory: ['@doctrine.orm.default_entity_manager', getRepository]
        arguments:
            - Wolnosciowiec\FileRepositoryBundle\Model\Entity\CachedResource

    # registry for cached resources
    wolnosciowiec.file_repository.local_resource_registry:
        class: Wolnosciowiec\FileRepositoryBundle\Service\Manager\LocalResourceRegistry
        arguments:
            repository: "@wolnosciowiec.file_repository.repository.cached_resource"

    # serializes cached resources into data understandable by
    wolnosciowiec.file_repository.serializer.rmv:
        class: Wolnosciowiec\FileRepositoryBundle\Service\RMVSerializer